varinput_title,btn,btn_text,container,title_x,title_y,table,tr,td,data_x,data_y,array_x=[],array_y=[],arrayRegX_x=[],arrayRegX_y=[],xM,yM,controllBlank,controllNan,k=0,func,cor,corText,oncl=false,n,r;functionTitle(x){vartitle;vartext;title=document.createElement("section");title.setAttribute("id","input_title");text=document.createTextNode(x);title.appendChild(text);document.getElementById("input_container").appendChild(title);}functionButton(a,b,c,d){btn=document.createElement("button");btn.setAttribute("onclick",b);if(d!=undefined){btn.setAttribute("id",d);}text=document.createTextNode(a);btn.appendChild(text);document.getElementById(c).appendChild(btn);}functionTable(a,b,c,d){vartext1=document.createTextNode(a);vartext2=document.createTextNode(b);vartext3=document.createTextNode(c);table=document.createElement("table");table.setAttribute("id","data_table");tr0=document.createElement("tr");tr0.setAttribute("id","data_tr0");tr=document.createElement("tr");tr.setAttribute("id","data_tr");th0=document.createElement("th");th0.setAttribute("id","data_th0");th0.setAttribute("colspan","2");th1=document.createElement("th");th1.setAttribute("id","data_th1");th2=document.createElement("th");th2.setAttribute("id","data_th2");document.getElementById(d).appendChild(table);document.getElementById("data_table").appendChild(tr0);document.getElementById("data_tr0").appendChild(th0);document.getElementById("data_table").appendChild(tr);document.getElementById("data_tr").appendChild(th1);document.getElementById("data_tr").appendChild(th2);th0.appendChild(text3);th1.appendChild(text1);th2.appendChild(text2);}functionInputContainer(){container=document.createElement("section");container.setAttribute("id","input_container");document.getElementById("regression_app").appendChild(container);}functionTableContainer(a,b){container=document.createElement("section");container.setAttribute("id",b);document.getElementById(a).appendChild(container);}functionGraphContainer(){container=document.createElement("section");container.setAttribute("id","graph_container");document.getElementById("regression_app").appendChild(container);}functionButtonContainer(){container=document.createElement("section");container.setAttribute("id","button_container");document.getElementById("input_container").appendChild(container);}functionDetailsContainer(a){container=document.createElement("section");container.setAttribute("id","details_container");document.getElementById(a).appendChild(container);}window.onload=function(){Default();Animations();Start();}functionDefault(){title_container=document.createElement("div");title_container.setAttribute("id","title");title=document.createTextNode("Rettadiregressione");title_container.appendChild(title);author_container=document.createElement("p");author=document.createTextNode("StefanoLeggio");author_container.appendChild(author);title_container.appendChild(author_container);document.body.insertBefore(title_container,document.body.firstChild);}functionStart(){title_x=document.createElement("input");title_y=document.createElement("input");title_x.setAttribute("type","text");title_x.setAttribute("id","title_x");title_x.setAttribute("placeholder","Ascissa");title_y.setAttribute("type","text");title_y.setAttribute("id","title_y");title_y.setAttribute("placeholder","Ordinata");InputContainer();Title("Inserisciilnomedeifattoridaanalizzare");document.getElementById("input_container").appendChild(title_x);document.getElementById("input_container").appendChild(title_y);ButtonContainer();Button("Prosegui","Data()","button_container");}functionData(){title_x=document.getElementById("title_x").value;title_y=document.getElementById("title_y").value;Controll(title_x,title_y);if(controllBlank){ErrorTitle();}else{document.getElementById("input_container").remove();Animations();InputContainer();data_x=document.createElement("input");data_x.setAttribute("type","text");data_x.setAttribute("id","data_x");data_x.setAttribute("placeholder",title_x);data_y=document.createElement("input");data_y.setAttribute("type","text");data_y.setAttribute("id","data_y");data_y.setAttribute("placeholder",title_y);Title("Inserisciidati");document.getElementById("input_container").appendChild(data_x);document.getElementById("input_container").appendChild(data_y);ButtonContainer();Button("Aggiungi","AddData()","button_container");Button("Elimina","RemoveData()","button_container","delete_button");Button("Esempio","Example()","button_container","example_button");Button("Calcola","RegressionLine()","button_container");}}functionRegressionLine(){if(array_x.length<3){ErrorGraph();}else{document.getElementById("input_container").remove();Animations();GraphContainer();CreateGraph();details_container=document.createElement("span");p_func=document.createElement("p");p_cor=document.createElement("p");p_af=document.createElement("p");details_container.setAttribute("id","details_container");details_func=document.createTextNode("Funzionerettadiregressione:"+func);details_r=document.createTextNode("Correlazionelineare:"+cor);details_af=document.createTextNode("Affidabilità:"+corText+"("+Math.round(r*100)+"%)");p_func.appendChild(details_func);p_cor.appendChild(details_r);p_af.appendChild(details_af);details_container.appendChild(p_func);details_container.appendChild(p_cor);details_container.appendChild(p_af);document.getElementById("graph_container").insertBefore(details_container,document.getElementById("graph_container").childNodes[0]);tr3=document.createElement("tr");tr3.setAttribute("id","data_tr3");th3=document.createElement("th");th3.setAttribute("colspan","2");th3.setAttribute("id","data_th3");document.getElementById("data_table").appendChild(tr3);document.getElementById("data_tr3").appendChild(th3);Button("Termina","End()","data_th3","end_button");}}functionEnd(){location.reload();}functionAnimations(){document.body.style.overflow="hidden";setTimeout(function(){document.body.style.overflow="auto";},2000);}functionControll(x,y){if(x==""||y==""){controllBlank=true;}else{controllBlank=false;}if(isNaN(x)||isNaN(y)){controllNan=true;}else{controllNan=false;}}functionErrorTitle(){alert("Nonpuoilasciareinbianco!");console.log("Nonpuoilasciareinbianco!");}functionErrorData(){alert("Puoiinseriresolonumerienonpuoilasciarenullo");console.log("Puoiinseriresolonumerienonpuoilasciarenullo");}functionErrorGraph(){alert("Idatiinseritisonotroppopochi!");console.log("Idatiinseritisonotroppopochi!");}functionAddData(){data_x=document.getElementById("data_x").value;data_y=document.getElementById("data_y").value;Controll(data_x,data_y);if(controllNan||controllBlank){ErrorData();}else{if(k==0){Animations();oncl=true;TableContainer("regression_app","table_container");Table(title_x,title_y,"Dati","table_container");}data_x=parseFloat(data_x);data_y=parseFloat(data_y);k++;table=document.getElementById("data_table");row=table.insertRow(-1);varcellx=row.insertCell(-1);varcelly=row.insertCell(-1);cellx.innerHTML=data_x;celly.innerHTML=data_y;array_x.push(data_x);array_y.push(data_y);document.getElementById("data_x").value="";document.getElementById("data_y").value="";}}functionRemoveData(){x=document.getElementById("data_table").rows.length;array_x.pop();array_y.pop();if(x>2){document.getElementById("data_table").deleteRow(-1);}}functionExample(){array_x=[];array_y=[];if(oncl){document.getElementById("table_container").remove();}Animations();TableContainer("regression_app","table_container");title_x="Redditomensile";title_y="Speseannualiperleferie";array_x.push(1.1,1.65,1.92,2.75,3.57);array_y.push(0.89,1.07,1.78,2.23,2.5);Table(title_x,title_y,"Dati","table_container");table=document.getElementById("data_table");n=array_x.length;for(vari=0;i<n;i++){row=table.insertRow(-1);cellx=row.insertCell(-1);celly=row.insertCell(-1);cellx.innerHTML=array_x[i];celly.innerHTML=array_y[i];}RegressionLine();}functionCreateGraph(){CalcolateRegressionLine();vardata={x:array_x,y:array_y,mode:"markers",name:"Dati",type:"scatter",marker:{size:12,color:"1a9992"}};varregX={x:arrayRegX_x,y:arrayRegX_y,name:"Rettadiregressione",mode:"lines",marker:{size:12,color:"ff8000"}};varM={x:[xM],y:[yM],mode:"markers",name:"Puntomedio",type:"scatter",marker:{size:12,color:"730099"}};varlayout={width:1000,height:700,xaxis:{title:"X"+""+title_x,titlefont:{size:15,color:"#7f7f7f"}},yaxis:{title:"Y"+""+title_y,titlefont:{size:15,color:'#7f7f7f'}}};vardata=[data,M,regX];Plotly.newPlot('graph_container',data,layout,{displayModeBar:false});}functionCalcolateRegressionLine(){varxS=0;varyS=0;n=array_x.length;varmx;varmy;varqx;vara;varb;varCy;varcoxy=0;varcox=0;varcoy=0;for(i=0;i<n;i++){xS+=array_x[i];yS+=array_y[i];}xM=xS/n;yM=yS/n;for(i=0;i<n;i++){coxy+=(array_x[i]-xM)*(array_y[i]-yM);cox+=Math.pow(array_x[i]-xM,2);coy+=Math.pow(array_y[i]-yM,2);}mx=coxy/cox;my=coxy/coy;qx=yM-mx*xM;for(i=0;i<n;i++){Cy=mx*array_x[i]+qx;arrayRegX_x.push(array_x[i]);arrayRegX_y.push(Cy);}r=Math.sqrt(mx*my);console.log("Arraydeidati");console.log("X:"+array_x);console.log("Y:"+array_y);console.log("");console.log("Arraypuntomedio");console.log("X:"+xM);console.log("Y:"+yM);console.log("");console.log("Arraydeipuntidellaretta");console.log("X:"+arrayRegX_x);console.log("Y:"+arrayRegX_y);console.log("");console.log("Coefficienteangolare");console.log("m:"+mx);console.log("");console.log("Intercetta");console.log("q:"+qx);console.log("");console.log("Coefficientedicorrelazionelineare");console.log("r:"+r);mx=mx.toFixed(3);qx=qx.toFixed(3);my=my.toFixed(3);r=r.toFixed(3);if(mx==0){a="";}elseif(mx>0||mx<0){a=mx+"x";}elseif(mx==-1){a="-x";}elseif(mx==1){a="x";}if(qx==0){b="";}elseif(qx>0){b="+"+qx;}elseif(qx<0){b="-"+qx*(-1);}func="y"+"="+a+b;cor="r"+"="+r;if(r>0.5||r<-0.5){corText="Abbastanzaaffidabile";if(r>0.75||r<-0.75){corText="Moltoaffidabile";if(r==1||r==-1){corText="Massimaaffidabilità";}}}elseif(r<0.5||r>-0.5){corText="Scarsamenteaffidabile"if(r<0.75||r>-0.75){corText="Pocoaffidabile"if(r==0){corText="Nonesiste"}}}}